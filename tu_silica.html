
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Yaff experiments on alpha quartz with the BKS potential &mdash; Yaff 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Yaff 1.0 documentation" href="index.html" />
    <link rel="next" title="1. yaff – YAFF - Yet another force field" href="rg_yaff.html" />
    <link rel="prev" title="11. Tuning force field parameters" href="ug_tune.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_yaff.html" title="1. yaff – YAFF - Yet another force field"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ug_tune.html" title="11. Tuning force field parameters"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Yaff 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="yaff-experiments-on-alpha-quartz-with-the-bks-potential">
<span id="tu-sec-silica"></span><h1>1. Yaff experiments on alpha quartz with the BKS potential<a class="headerlink" href="#yaff-experiments-on-alpha-quartz-with-the-bks-potential" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>1.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces some basic features of Yaff with the aid of relatively
simple simulations using the BKS force field <a class="reference internal" href="#bks1990">[BKS1990]</a>. The files needed for
this tutorial are distributed with the source code of Yaff in the directory
<tt class="docutils literal"><span class="pre">data/examples/001_toturial_bks</span></tt>. This tutorial assumes that you have
successfuly installed Yaff. (See <a class="reference internal" href="ug_install.html#ug-sec-install"><em>Installation</em></a> for more details.)</p>
<p>A copy of the latest source code with the examples can be obtained with the
following commands:</p>
<div class="highlight-python"><pre>git clone git://github.com/molmod/yaff.git
cd yaff/data/examples/001_tutorial_bks</pre>
</div>
<p>The directory <tt class="docutils literal"><span class="pre">data/examples/001_toturial_bks</span></tt> contains three directories
(<tt class="docutils literal"><span class="pre">init</span></tt>, <tt class="docutils literal"><span class="pre">opt</span></tt> and <tt class="docutils literal"><span class="pre">nvt</span></tt>) and a file <tt class="docutils literal"><span class="pre">bks.pot</span></tt>. The latter contains the
parameters of the BKS force field. The <tt class="docutils literal"><span class="pre">init</span></tt> directory just contains a script
and some input data to set up the initial structure of alpha quartz. The
directories <tt class="docutils literal"><span class="pre">opt</span></tt> and <tt class="docutils literal"><span class="pre">nvt</span></tt> each contain a simulation script
(<tt class="docutils literal"><span class="pre">simulation.py</span></tt>) and an analysis script (<tt class="docutils literal"><span class="pre">analysis.py</span></tt>). All scripts
contain an abundant amount of comments to explain each step and the parameters
that are used. The simulation script in the <tt class="docutils literal"><span class="pre">opt</span></tt> directory can be used to
optimize the positions of the nuclei and/or the cell geometry. The corresponding
analysis script can be used to fit the bulk modulus to a series of
<img class="math" src="_images/math/8fabe26277a6f81a2954bc94ea81542190c5023c.png" alt="(p,V,E)" style="vertical-align: -4px"/> data points. The directory <tt class="docutils literal"><span class="pre">nvt</span></tt> contains a simulation script
to run an NVT simulation on the quartz system. The analysis script computes the
average pressure and the error on that average.</p>
</div>
<div class="section" id="preparation">
<h2>1.2. Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<p>In order to prepare an initial structure, run the script <tt class="docutils literal"><span class="pre">mksystem.py</span></tt> in the
directory <tt class="docutils literal"><span class="pre">init</span></tt>:</p>
<div class="highlight-python"><pre>cd init
python mksystem.py</pre>
</div>
<p>This script uses data from the files <tt class="docutils literal"><span class="pre">rvecs.txt</span></tt> and <tt class="docutils literal"><span class="pre">struct.xyz</span></tt> to
construct an initial state for the simulations in the following section. One may
modify the scripts to construct alternative initial states.</p>
</div>
<div class="section" id="bulk-modulus">
<h2>1.3. Bulk modulus<a class="headerlink" href="#bulk-modulus" title="Permalink to this headline">¶</a></h2>
<p>The goal of the first assignment is to estimate the bulk modulus of quartz at
<img class="math" src="_images/math/eb88a988b0126b7b196ca7035f1f920ddf3659ee.png" alt="T=0K" style="vertical-align: 0px"/> and an external pressure of <img class="math" src="_images/math/192270ca9a494d4e16e9c0709f23f4cf9309490f.png" alt="p_\text{ext}=0\;\text{bar}" style="vertical-align: -4px"/>.
This result can be obtained in (at least) two ways, either by fitting a linear
model to the <img class="math" src="_images/math/afeeafd0997e809fb5e6d315334e7522f5ea75ba.png" alt="p(V)" style="vertical-align: -4px"/> relation, or by fitting a quadratic model to the
<img class="math" src="_images/math/21839f7bdb8dffa9c6e07452c872439acd0bc41c.png" alt="E(V)" style="vertical-align: -4px"/> relation. More advanced approaches such as a fit to the
<a class="reference external" href="http://en.wikipedia.org/wiki/Birch%E2%80%93Murnaghan_equation_of_state">Birch&#8211;Murnaghan equation of state</a> or a
direct computation of <img class="math" src="_images/math/9248ee96799c579f1a99332ee95e1bb7b5d8a673.png" alt="\frac{d^2 E}{d V^2}" style="vertical-align: -6px"/> are also possible but are not
discussed here for the sake of simplicity.</p>
<p>The script <tt class="docutils literal"><span class="pre">simulation.py</span></tt> in the directory <tt class="docutils literal"><span class="pre">opt</span></tt> can be used to optimize
the structure of a quartz with a given external pressure. It uses the file
<tt class="docutils literal"><span class="pre">init.chk</span></tt> from the directory <tt class="docutils literal"><span class="pre">init</span></tt> as the initial structure for the
optimization. The script can be executed as follows: <tt class="docutils literal"><span class="pre">python</span> <span class="pre">simulation.py</span></tt>.</p>
<p>As a final result, the individual contributions to the total force field energy
of the optimized system and the optimal cell volume are printed on screen. Run
several tests to see which values for the parameters in the script
<tt class="docutils literal"><span class="pre">simulation.py</span></tt> are suitable. The script creates several additional output
files that can be used to analyze the optimization:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">traj.xyz</span></tt>: a trajectory file with the nuclear coordinates at each time step
that can be visualized with Molden, VMD and many other programs, e.g. <tt class="docutils literal"><span class="pre">molden</span>
<span class="pre">traj.xyz</span></tt></li>
<li><tt class="docutils literal"><span class="pre">opt_energy.png</span></tt>: a figure with the energy contributions as function of the
optimization step. This file can be viewed with the command <tt class="docutils literal"><span class="pre">display</span>
<span class="pre">opt_energy.png</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">opt_cell.png</span></tt>: a figure with the cell parameters as function of the
optimization step. This file can be viewed with the command <tt class="docutils literal"><span class="pre">display</span>
<span class="pre">opt_cell.png</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">opt.chk</span></tt>: a file with the optimized structure.</li>
</ul>
<p>Once an acceptable set of <img class="math" src="_images/math/8fabe26277a6f81a2954bc94ea81542190c5023c.png" alt="(p,V,E)" style="vertical-align: -4px"/> datapoints are obtained, these values
can be added to the beginning of the script <tt class="docutils literal"><span class="pre">analysis.py</span></tt>. Run this script
(python <tt class="docutils literal"><span class="pre">analysis.py</span></tt>) to perform the fitting procedure. Besides the screen
output, two figures are generated: <tt class="docutils literal"><span class="pre">pv.png</span></tt> and <tt class="docutils literal"><span class="pre">ev.png</span></tt>, which contain your
data and the fitted models. The data point with the smallest pressure (in
absolute value) is used as the reference point for the fit.</p>
<p>If you are familiar with the Python language, it is worthwhile to add a loop
over different external pressures in the script <tt class="docutils literal"><span class="pre">simulation.py</span></tt>. This makes it
far easier to solve the problem. Furthermore, one further speed up one&#8217;s work
flow by writing the essential output of <tt class="docutils literal"><span class="pre">simulation.py</span></tt> to a data file that
can be read in the <tt class="docutils literal"><span class="pre">analysis.py</span></tt> script,</p>
</div>
<div class="section" id="thermal-expansion">
<h2>1.4. Thermal expansion<a class="headerlink" href="#thermal-expansion" title="Permalink to this headline">¶</a></h2>
<p>The volumetric thermal expansion in the limit of <img class="math" src="_images/math/eb88a988b0126b7b196ca7035f1f920ddf3659ee.png" alt="T=0K" style="vertical-align: 0px"/> can be estimated with the following relation:</p>
<div class="math">
<p><img src="_images/math/7360809d8a1ced4ef9bff09b2e8359c16f1e3c0a.png" alt="p = 3 B \alpha_V T"/></p>
</div><p>where <img class="math" src="_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p" style="vertical-align: -4px"/> is the pressure, <img class="math" src="_images/math/ff5fb3d775862e2123b007eb4373ff6cc1a34d4e.png" alt="B" style="vertical-align: 0px"/> is the bulk modulus at <img class="math" src="_images/math/eb88a988b0126b7b196ca7035f1f920ddf3659ee.png" alt="T=0K" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/737098880242860bea99b4f9f48a38ab56d52759.png" alt="\alpha_V" style="vertical-align: -3px"/> is the thermal expansion coefficient at <img class="math" src="_images/math/eb88a988b0126b7b196ca7035f1f920ddf3659ee.png" alt="T=0K" style="vertical-align: 0px"/> and
<img class="math" src="_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T" style="vertical-align: 0px"/> is the temperature. The bulk modulus from the previous section can be
used. The goal of this section is to estimate <img class="math" src="_images/math/737098880242860bea99b4f9f48a38ab56d52759.png" alt="\alpha_V" style="vertical-align: -3px"/> for quartz from
several <img class="math" src="_images/math/dadf473091a55d821ddc17981743753cc5bd6bfb.png" alt="(p,T)" style="vertical-align: -4px"/> data points obtained with NVT molecular dynamics
simulations. The NVT simulations use the fixed optimized cell parameters from
the structure optimization at <img class="math" src="_images/math/eb88a988b0126b7b196ca7035f1f920ddf3659ee.png" alt="T=0K" style="vertical-align: 0px"/>. (See previous section.)</p>
<p>The script <tt class="docutils literal"><span class="pre">simulation.py</span></tt> in the directory <tt class="docutils literal"><span class="pre">nvt</span></tt> performs an NVT
simulation, using the optimized cell from the previous section as initial
structure. (Both the nuclear coordinates and the cell parameters from the
optimization are used. The cell parameters do not change during an NVT
simulation.) The script is executed as follows:</p>
<div class="highlight-python"><pre>python simulations.py 300 500</pre>
</div>
<p>The two parameters are the temperature of the thermostat and the number of
simulation steps, respectively. The script contains several parameters that one
may tune to obtain decent results. Especially the choice of the thermostat is
important for the statistical efficiency of the ensemble average of the
pressure. By commenting/uncommenting the appropriate lines in the script, one
may select one of the following thermostats:</p>
<ol class="arabic simple">
<li>The Andersen thermostat. In this algorithm, the nuclear velocities are
regularly reseted at random values from the Maxwell-Boltzmann distribution.</li>
<li>The Langevin thermostat. In this algorithm, the nuclei are slowed down by a
uniform friction coefficient and accelerated by additional random nuclear
forces (collisions with an external bath). Both effects are in equilibrium at
the requested temperature. The two main parameters are the temperature
(obviously) and a time constant that determines the time horizon of the
nuclear motion.</li>
<li>The Nosé-Hoover chains (NHC) thermostat. This method couples the nuclear
motion to a fictitious degree of freedom that represents the heat bath. The
equations of motion only deviate very mildly from the regular Newton
equations of motion. Just like the Langevin thermostat, this thermostat is
controlled mainly by two parameters: the temperature and a time constant.</li>
</ol>
<p>The script <tt class="docutils literal"><span class="pre">simulation.py</span></tt> generates the following output files, where
<tt class="docutils literal"><span class="pre">NNNN</span></tt> is the temperature and <tt class="docutils literal"><span class="pre">MMMMMM</span></tt> is the number of iterations in the
Verlet algorithm:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">traj_NNNN_MMMMMM.xyz</span></tt>. This can be used to visualize the time-dependent
nuclear positions, e.g. with VMD.</li>
<li><tt class="docutils literal"><span class="pre">traj_NNNN_MMMMMM.h5</span></tt>. This a binary trajectory file (similar to
<tt class="docutils literal"><span class="pre">traj_NNNN_MMMMMM.xyz</span></tt>) that contains all time-dependent information from
the NVT simulation. It is used for the post processing of the simulation. One
may request the contents of such file with <tt class="docutils literal"><span class="pre">h5dump</span> <span class="pre">-n</span> <span class="pre">traj_NNNN_MMMMMM.h5</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">ener_NNNN_MMMMMM.png</span></tt>. This is a plot with the time dependent energies.</li>
<li><tt class="docutils literal"><span class="pre">temp_NNNN_MMMMMM.png</span></tt>. This is a plot with the time temperature.</li>
<li><tt class="docutils literal"><span class="pre">press_NNNN_MMMMMM.png</span></tt>. This is a plot with the time pressure.</li>
</ul>
<p>The script <tt class="docutils literal"><span class="pre">analysis.py</span></tt> computes the average pressure and the error on the
average using the block-average method. The script is executed as follows:</p>
<div class="highlight-python"><pre>python analysis.py 300 500 20</pre>
</div>
<p>where the three parameters are the temperature, the length of the simulation and
the number of initial steps to be omitted from the analysis. (Some initial data
points should be omitted because the first part of the simulation consists of an
equilibration period that is not suitable for the computation of ensemble
averages.) This script also generates a plot with the normalized time
correlation function of the pressure and the fitting results of the block
average method. (See <tt class="docutils literal"><span class="pre">ac_NNNN_MMMMMM.png</span></tt> and <tt class="docutils literal"><span class="pre">blav_NNNN_MMMMMM.png</span></tt>.)</p>
<p>Feel free to modify both scripts in order to obtain the results as efficiently
as possible. The NVT simulations may take a few minutes, especially when longer
runs are requested. In those cases it is recommended to submit the simulations
on a queuing system.</p>
</div>
<div class="section" id="references">
<h2>1.5. References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="bks1990" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[BKS1990]</a></td><td>van Beest, B. W. H., Kramer, G. J. &amp; van Santen, R. A. &#8216;Force
fields for silicas and aluminophosphates based on ab initio calculations&#8217;.
<em>Phys. Rev. Lett.</em> <strong>64</strong>, 1955-1958 (1990). URL
<a class="reference external" href="http://dx.doi.org/10.1103/PhysRevLett.64.1955">http://dx.doi.org/10.1103/PhysRevLett.64.1955</a>.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Yaff experiments on alpha quartz with the BKS potential</a><ul>
<li><a class="reference internal" href="#introduction">1.1. Introduction</a></li>
<li><a class="reference internal" href="#preparation">1.2. Preparation</a></li>
<li><a class="reference internal" href="#bulk-modulus">1.3. Bulk modulus</a></li>
<li><a class="reference internal" href="#thermal-expansion">1.4. Thermal expansion</a></li>
<li><a class="reference internal" href="#references">1.5. References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ug_tune.html"
                        title="previous chapter">11. Tuning force field parameters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rg_yaff.html"
                        title="next chapter">1. <tt class="docutils literal"><span class="pre">yaff</span></tt> &#8211; YAFF - Yet another force field</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tu_silica.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_yaff.html" title="1. yaff – YAFF - Yet another force field"
             >next</a> |</li>
        <li class="right" >
          <a href="ug_tune.html" title="11. Tuning force field parameters"
             >previous</a> |</li>
        <li><a href="index.html">Yaff 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Toon Verstraelen, Louis Vanduyfhuys.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>